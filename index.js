import{A as Z,a as f,i as A,R as ee,S as te,N as re,P as oe}from"./assets/vendor-lXkXHKPV.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const T=document.querySelector(".order-modal"),c=document.querySelector(".modal-window"),r={categories:document.querySelector("#categories"),products:document.querySelector("#products"),popularProducts:document.querySelector("#popular-products"),loadMoreBtn:document.querySelector(".load-more-btn"),popularNavPrev:document.querySelector(".popular-nav-prev"),popularNavNext:document.querySelector(".popular-nav-next"),popularPaginationDots:document.querySelector(".popular-pagination-dots"),feedbackCardList:document.querySelector(".feedback-card-list"),feedbackNavPrev:document.querySelector(".feedback-nav-prev"),feedbackNavNext:document.querySelector(".feedback-nav-next"),feedbackPaginationDots:document.querySelector(".feedback-pagination-dots"),feedbackSwiper:document.querySelector(".feedback-swiper"),loader:document.querySelector(".backdrope-loader"),backdropOrderModal:document.querySelector(".backdrop"),modalOrder:T,closeOrderBtn:T?.querySelector(".modal-close-btn"),submitBtn:T?.querySelector(".modal-submit-btn"),orderForm:T?.querySelector(".modal-order-form"),productModal:c,productModalDialog:c?.querySelector(".product-modalWindow"),productModalMainImg:c?.querySelector(".modal-image-0"),productModalThumbsWrap:c?.querySelector(".modal-bottom-row"),productModalTitle:c?.querySelector(".product-modal-title"),productModalCategory:c?.querySelector(".modal-description"),productModalPrice:c?.querySelector(".modal-price"),productModalStars:c?.querySelector(".modal-rating-stars"),productModalColorsWrap:c?.querySelector(".radio-group"),productModalDescription:c?.querySelector(".furnitureDescription"),productModalSize:c?.querySelector(".furnitureSize"),productModalCloseBtn:c?.querySelector(".modal-close-btn"),productModalOrderBtn:c?.querySelector(".modalButton"),burgerMenuOpenBtn:document.querySelector("[data-menu-open]"),burgerMenu:document.querySelector(".burger-menu"),burgerMenuHeaderNav:document.querySelector(".header-nav"),burgerMenuHeaderButton:document.querySelector(".burger-menu-header-button"),body:document.body,themeToggle:document.querySelector("[data-theme-toggle]")};function ae(e){const o=[{_id:"all",name:"Всі товари"},...e].map(({_id:a,name:n})=>`<li
        class="category-item" id="${a}"
        style="
          background-image: image-set(
            url('./furniture-bg/${a}.png') 1x,
            url('./furniture-bg/${a}@2x.png') 2x
          );
        "
      ><button class="categories-btn" type="button">${n}</button></li>`).join("");r.categories.innerHTML=o}function w(e,t=null){const o=t||r.products,a=e.map(({_id:n,name:s,images:i,price:l,color:m})=>`<li class="product-item" data-id="${n}">
        <img
          class="products-image"
          src='${i[0]}'
          alt="${s}"
        />
        <div class="product-description-box">
          <h4 class="products-title">${s}</h4>
          <ul class="products-color-list">
            ${m.map(j=>`<li class="products-color-box" style="background-color: ${j}"></li>`).join("")}
          </ul>
          <p class="products-price">${l} грн</p>
        </div>
        <button class="products-details-btn" type="button">Детальніше</button>
      </li>`).join("");o.insertAdjacentHTML("beforeend",a)}function ne(){r.products.innerHTML=""}new Z(".accordion-container",{duration:300,showMultiple:!1,beforeOpen:e=>{const t=e.querySelector(".ac-icon");t&&(t.style.transform="translateY(-50%) rotate(180deg)")},beforeClose:e=>{const t=e.querySelector(".ac-icon");t&&(t.style.transform="translateY(-50%) rotate(0deg)")}});const se="https://furniture-store-v2.b.goit.study/api",M={FURNITURES:"/furnitures",CATEGORIES:"/categories",FEEDBACKS:"/feedbacks",ORDERS:"/orders"},K=1,h=8,ie=1,V=10,ce=e=>`/furnitures/${e}`;f.defaults.baseURL=se;async function le(){return(await f.get(M.CATEGORIES)).data}async function X(e=K){const{data:t}=await f(`${M.FURNITURES}?page=${e}&limit=${h}`);return t}async function Y(e,t){const{data:o}=await f(`${M.FURNITURES}?page=${t}&limit=${h}&category=${e}`);return o}async function de(e=K){const{data:t}=await f(`${M.FURNITURES}?page=${e}&limit=${h}&type=popular`);return t}async function ue(e){const t=ce(e);return(await f.get(t)).data}async function pe(e={page:ie,limit:V}){return(await f.get(M.FEEDBACKS,{params:e})).data}async function fe(e){return(await f.post(M.ORDERS,e)).data}function U(){setTimeout(()=>{r.loadMoreBtn.classList.add("is-show")},500)}function g(){r.loadMoreBtn.classList.remove("is-show")}function me(e){return e<1||e>5?e:e>=3.3&&e<=3.7?3.5:e>=3.8&&e<=4.2?4:Math.round(e*2)/2}A.settings({position:"topRight",displayMode:"replace",timeout:4e3,progressBar:!1});function E(e){A.info({message:e})}function be(e){A.success({message:e})}function u(e){A.warning({message:e})}function k(e){A.error({message:e.message})}function B(){r.loader.classList.remove("hidden"),g()}function C(){r.loader.classList.add("hidden")}let _=null,J=null;function ge(){localStorage.removeItem("order-form")}function ve(e,t){if(!e||!t)return u("Please fill in your name and phone number."),!1;if(!_)return u("Choose a product before ordering."),!1;let o=t.replace(/\D/g,"");return o.length<10?(u("Enter a valid phone number (at least 10 digits)."),!1):(o.startsWith("0")&&(o="38"+o),o.length!==12&&!o.match(/^\d{10,15}$/)?(u("Enter a valid phone number in format: +38 (0XX) XXX-XX-XX or 380XXXXXXXXX"),!1):o.length===12&&o.match(/^\d{12}$/)?o:o.length>=10&&o.length<=15?o.length>12?o.substring(0,12):o:(u("Enter a valid phone number."),!1))}function ye(){r.orderForm.querySelectorAll("input, textarea").forEach(e=>{e.addEventListener("input",()=>{const t={};r.orderForm.querySelectorAll("input, textarea").forEach(o=>{o.name&&(t[o.name]=o.value)}),localStorage.setItem("order-form",JSON.stringify(t))})})}async function he(e){e.preventDefault();const t=r.orderForm.elements["user-name"]?.value.trim(),o=r.orderForm.elements["user-phone"]?.value.trim();r.orderForm.elements["user-comment"]?.value.trim();const a=ve(t,o);if(!a)return;const n={name:t,phone:a,comment:"empty",modelId:_,color:J};r.submitBtn.disabled=!0;try{B(),await fe(n),be("Your order has been sent!"),r.orderForm.reset(),ge(),q()}catch(s){k(s)}finally{C(),r.submitBtn.disabled=!1}}async function Me(e,t,o){document.body.classList.add("modal-open"),_=e??null,J=o??null,r.backdropOrderModal.classList.add("is-open"),ke(),ct()}async function q(){document.body.classList.remove("modal-open"),r.backdropOrderModal.classList.remove("is-open"),lt()}function ke(){const e=localStorage.getItem("order-form");if(e)try{const t=JSON.parse(e);r.orderForm.querySelectorAll("input, textarea").forEach(o=>{o.name&&t[o.name]!==void 0&&(o.value=t[o.name])})}catch(t){console.error("Помилка при відновленні даних форми:",t)}}function Ee(e=0){const t=Math.floor(e),o=e%1>=.5?1:0;let a="";for(let n=0;n<t;n++)a+='<span class="star star-full">★</span>';o&&(a+='<span class="star star-half">★</span>');for(let n=t+o;n<5;n++)a+='<span class="star star-empty">★</span>';return a}function Le(e){const t="https://furniture-store-v2.b.goit.study";return(e||[]).map(o=>typeof o=="string"&&o.startsWith("http")?o:`${t}${o}`)}function Pe(){return{dialog:r.productModalDialog,mainImg:r.productModalMainImg,thumbsWrap:r.productModalThumbsWrap,titleEl:r.productModalTitle,catEl:r.productModalCategory,priceEl:r.productModalPrice,starsEl:r.productModalStars,colorsWrap:r.productModalColorsWrap,descEl:r.productModalDescription,sizeEl:r.productModalSize,btnClose:r.productModalCloseBtn,orderBtn:r.productModalOrderBtn}}function Se(e,t,o,a){if(!e||!t)return;const n=o.length?o:["https://via.placeholder.com/640x360?text=No+Image"],s=n[0],i=n.slice(1,3);e.src=s,e.alt=a||"photo",t.innerHTML=i.map(l=>`<img class="modal-thumb" src="${l}" alt="${a||"thumb"}">`).join("")}function we(e,t){if(!e)return;const o=Array.isArray(t)?t:[];e.innerHTML=o.map((a,n)=>`<label>
          <input type="radio" name="color" value="${a}" ${n===0?"checked":""}>
          <span class="color-circle" style="background:${a}"></span>
        </label>`).join("")}function Ne(e,t){const{titleEl:o,catEl:a,priceEl:n,starsEl:s,descEl:i,sizeEl:l}=e;o&&(o.textContent=t?.name||""),a&&(a.textContent=t?.category?.name||"Без категорії"),n&&(n.textContent=`${t?.price??0} грн`),s&&(s.innerHTML=Ee(t?.rate||0)),i&&(i.textContent=t?.description||"Опис відсутній"),l&&(l.textContent=`Розміри: ${t?.sizes||"—"}`)}async function Ae(e){try{B(),document.body.classList.add("modal-open"),r.productModal.classList.remove("visuallyhidden");const t=await ue(e),o=Pe(),a=Le(t.images||t.image||[]);Se(o.mainImg,o.thumbsWrap,a,t?.name),Ne(o,t),we(o.colorsWrap,t?.color),st(o,e)}catch(t){k(t)}finally{C()}}function x(){r.productModal.classList.add("visuallyhidden"),document.body.classList.remove("modal-open"),it()}const D=4;let d=0,W=[];function Be(e=[]){W=e,d=0,I(0),Q(),Ie()}function Ce(e){const t=e*D,o=t+D;return W.slice(t,o)}function O(){return Math.ceil(W.length/D)}function I(e){const t=O();if(e<0||e>=t)return;d=e,r.popularProducts&&(r.popularProducts.innerHTML="");const a=Ce(e).map(n=>`<li class="product-item" data-id="${n._id}">
      <img
        class="products-image"
        src='${n.images[0]}'
        alt="${n.name}"
      />
      <div class="product-description-box">
        <h4 class="products-title">${n.name}</h4>
        <ul class="products-color-list">
          ${n.color.map(s=>`<li class="products-color-box" style="background-color: ${s}"></li>`).join("")}
        </ul>
        <p class="products-price">${n.price} грн</p>
      </div>
      <button class="products-details-btn" type="button">Детальніше</button>
    </li>`).join("");r.popularProducts&&r.popularProducts.insertAdjacentHTML("beforeend",a),Q(),Te()}function Q(){const e=O();if(r.popularPaginationDots){r.popularPaginationDots.innerHTML="";for(let t=0;t<e;t++){const o=document.createElement("li");o.className=t===d?"active":"",o.setAttribute("data-page",t),o.setAttribute("aria-label",`Page ${t+1}`),o.setAttribute("role","button"),o.addEventListener("click",()=>{I(t)}),r.popularPaginationDots.appendChild(o)}}}function Te(){const e=O(),t=d===0,o=d===e-1;r.popularNavPrev&&(t?(r.popularNavPrev.setAttribute("disabled","true"),r.popularNavPrev.classList.add("disabled"),r.popularNavPrev.setAttribute("aria-disabled","true")):(r.popularNavPrev.removeAttribute("disabled"),r.popularNavPrev.classList.remove("disabled"),r.popularNavPrev.setAttribute("aria-disabled","false"))),r.popularNavNext&&(o?(r.popularNavNext.setAttribute("disabled","true"),r.popularNavNext.classList.add("disabled"),r.popularNavNext.setAttribute("aria-disabled","true")):(r.popularNavNext.removeAttribute("disabled"),r.popularNavNext.classList.remove("disabled"),r.popularNavNext.setAttribute("aria-disabled","false")))}function Ie(){r.popularNavPrev&&r.popularNavPrev.addEventListener("click",()=>{d>0&&I(d-1)}),r.popularNavNext&&r.popularNavNext.addEventListener("click",()=>{const e=O();d<e-1&&I(d+1)})}let b=1,v="";async function qe(){try{B();const e=await le();ae(e),v="all",r.categories.children[0].classList.add("categories-item--active");const{furnitures:o}=await X();w(o),U();const{furnitures:a}=await de();a&&a.length>0&&Be(a)}catch(e){k(e)}finally{C()}}async function xe(e){const t=e.target.closest(".category-item");if(!t)return;[...e.currentTarget.children].map(a=>{a.classList.remove("categories-item--active")}),ne(),t.classList.add("categories-item--active"),b=1,v=t.id,B();try{if(v==="all"){const{furnitures:a}=await X();w(a),U()}else{const{furnitures:a,totalItems:n}=await Y(v,b);if(a.length)n<h&&(g(),E(`Ended furnitures collections in "${t.textContent}" categories`)),w(a);else{g(),E(`Furnitures in "${t.textContent}" categories is not found`);return}}}catch(a){k(a)}finally{C()}}async function Oe(e){e.preventDefault(),b++,B();try{if(v==="all"){const{furnitures:t,totalItems:o}=await X(b);o<h*b?(g(),E("End collections")):U(),w(t)}else{const{furnitures:t,totalItems:o}=await Y(v,b);if(t.length)o<h&&(g(),E("End collections")),w(t);else{g(),E("Furnitures is not found");return}}}catch(t){k(t)}finally{C()}}const G=e=>{const t=e.target.closest(".products-details-btn");if(!t)return;const o=t.closest(".product-item");if(!o)return;let a=o.dataset.id;if(!a){const i=(o.querySelector('img[src*="/furniture/"]')?.getAttribute("src")||"").match(/\/([a-f0-9]{24})_/i);i&&(a=i[1])}if(!a){u("ID not found");return}e.preventDefault(),Ae(a)};function Fe(){requestAnimationFrame(()=>{window.scrollTo({top:0,left:0,behavior:"auto"})})}function $e(e,t,o,a){e.classList.add("is-open"),t.classList.add("no-scroll"),o.style.display="none",a.style.display="flex"}function De(e,t,o,a){e.classList.remove("is-open"),t.classList.remove("no-scroll"),o.style.display="flex",a.style.display="none"}function Re(e,t,o){e.key==="Escape"&&t.classList.contains("is-open")&&o()}function He(e){e.target===r.productModal&&x()}function Xe(e){e.key==="Escape"&&x()}function Ue(e){const t=r.productModal.querySelector('input[name="color"]:checked'),o=t?t.value:null;x(),Me(e,null,o)}function _e(e,t){const o=e.target.closest(".modal-thumb");if(!o||!t)return;const a=t.src;t.src=o.src,o.src=a}function We(e){e.key==="Escape"&&q()}function je(){q()}function Ge(e){e.target===r.backdropOrderModal&&q()}let p=null;function ze(e=10){if(!(!r.feedbackSwiper||!r.feedbackCardList))return p&&(p.destroy(!0,!0),p=null),p=new te(r.feedbackSwiper,{modules:[re,oe],slidesPerView:1,slidesPerGroup:1,spaceBetween:24,loop:!1,grabCursor:!0,allowTouchMove:!0,touchRatio:1,simulateTouch:!0,watchSlidesProgress:!0,navigation:{nextEl:r.feedbackNavNext,prevEl:r.feedbackNavPrev},pagination:{el:r.feedbackPaginationDots,clickable:!0,bulletClass:"feedback-pagination-dot",bulletActiveClass:"active",type:"bullets",dynamicBullets:!1},breakpoints:{375:{slidesPerView:1,slidesPerGroup:1,spaceBetween:16},768:{slidesPerView:2,slidesPerGroup:1,spaceBetween:24},1200:{slidesPerView:3,slidesPerGroup:1,spaceBetween:24}},on:{init:function(){$()},slideChange:function(){$()},resize:function(){$()}}}),p}function $(){if(!p||!r.feedbackNavPrev||!r.feedbackNavNext)return;const e=p.isBeginning,t=p.isEnd;e?(r.feedbackNavPrev.setAttribute("disabled","true"),r.feedbackNavPrev.classList.add("disabled"),r.feedbackNavPrev.setAttribute("aria-disabled","true")):(r.feedbackNavPrev.removeAttribute("disabled"),r.feedbackNavPrev.classList.remove("disabled"),r.feedbackNavPrev.setAttribute("aria-disabled","false")),t?(r.feedbackNavNext.setAttribute("disabled","true"),r.feedbackNavNext.classList.add("disabled"),r.feedbackNavNext.setAttribute("aria-disabled","true")):(r.feedbackNavNext.removeAttribute("disabled"),r.feedbackNavNext.classList.remove("disabled"),r.feedbackNavNext.setAttribute("aria-disabled","false"))}async function Ke(){try{const t=(await pe({limit:V})).feedbacks||[];if(t.length===0){u("No feedbacks received from API");return}Je(t),setTimeout(()=>{ze(t.length)},50)}catch(e){k(e)}}async function Ve(){if(!r.feedbackSwiper||!r.feedbackCardList||!r.feedbackNavPrev||!r.feedbackNavNext||!r.feedbackPaginationDots){u("Feedback section elements not found in DOM");return}await Ke()}function Ye(e){const t=e.rate??0,o=me(t);return`
    <li class="swiper-slide feedback-card-item">
      <div class="feedback-rating" data-score="${o}" aria-label="Рейтинг ${o} з 5"></div>
      <p class="feedback-text">${e.descr||""}</p>
      <p class="feedback-author">${e.name||""}</p>
    </li>
  `}function Je(e){if(!r.feedbackCardList)return;const t=e.map(a=>Ye(a)).join("");r.feedbackCardList.innerHTML=t,r.feedbackCardList.querySelectorAll(".feedback-rating").forEach(a=>{const n=Number(a.dataset.score)||0;a.innerHTML="",new ee(a,{readOnly:!0,starType:"i",number:5,score:n,half:!0,halfShow:!0,starOn:"feedback-star-on",starOff:"feedback-star-off",starHalf:"feedback-star-half",space:!1}).init()})}const R="theme",N="light",y="dark";function Qe(){const e=localStorage.getItem(R);return e||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?y:N)}function H(e){e===y?(document.documentElement.setAttribute("data-theme",y),localStorage.setItem(R,y),z(!0)):(document.documentElement.setAttribute("data-theme",N),localStorage.setItem(R,N),z(!1))}function Ze(){return document.documentElement.getAttribute("data-theme")||N}function z(e){const t=r.themeToggle;if(!t)return;const o=t.querySelector(".theme-icon-sun"),a=t.querySelector(".theme-icon-moon");e?(o&&(o.style.display="none"),a&&(a.style.display="block")):(o&&(o.style.display="block"),a&&(a.style.display="none"))}function et(){const e=Ze();H(e===y?N:y)}function tt(){const e=Qe();H(e)}window.addEventListener("load",Fe);document.addEventListener("DOMContentLoaded",()=>{tt(),qe(),Ve(),nt(),at(),rt(),ot(),dt(),ut(),pt()});function rt(){r.categories&&!r.categories.dataset.bound&&(r.categories.addEventListener("click",xe),r.categories.dataset.bound="1")}function ot(){r.loadMoreBtn&&!r.loadMoreBtn.dataset.bound&&(r.loadMoreBtn.addEventListener("click",Oe),r.loadMoreBtn.dataset.bound="1")}function at(){const e=r.products||document.getElementById("products");e&&e.dataset.boundModal!=="1"&&(e.addEventListener("click",G),e.dataset.boundModal="1");const t=r.popularProducts||document.getElementById("popular-products");t&&t.dataset.boundModal!=="1"&&(t.addEventListener("click",G),t.dataset.boundModal="1")}function nt(){const e=r.burgerMenuOpenBtn,t=r.burgerMenu,o=r.burgerMenuHeaderNav,a=r.burgerMenuHeaderButton,n=r.body;if(!e||!t||!o){console.warn("Не знайдено елементи меню або хедеру");return}const s=document.createElement("button");s.classList.add("burger-menu-navbar-btn-close"),s.setAttribute("type","button"),s.setAttribute("data-navbar-close","");const i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.classList.add("burger-button-icon"),i.setAttribute("width","32"),i.setAttribute("height","32");const l=document.createElementNS("http://www.w3.org/2000/svg","use");l.setAttributeNS("http://www.w3.org/1999/xlink","href","/img/sprite.svg#x"),i.appendChild(l),s.appendChild(i),e.insertAdjacentElement("beforebegin",s);const m=()=>{De(t,n,e,s)};e.addEventListener("click",()=>{$e(t,n,e,s)}),s.addEventListener("click",m),a?.addEventListener("click",m),t.querySelectorAll(".nav-link").forEach(F=>F.addEventListener("click",m)),document.addEventListener("keydown",F=>{Re(F,t,m)}),s.style.display="none"}let L=null,P=null;function st(e,t){const{btnClose:o,orderBtn:a,dialog:n,thumbsWrap:s,mainImg:i}=e;o&&(o.onclick=x),P=He,r.productModal.addEventListener("mousedown",P),L=Xe,document.addEventListener("keydown",L),a&&(a.onclick=()=>Ue(t)),s&&!s.dataset.bound&&(s.addEventListener("click",l=>{_e(l,i)}),s.dataset.bound="1"),n&&(n.setAttribute("tabindex","-1"),n.focus({preventScroll:!0}))}function it(){L&&(document.removeEventListener("keydown",L),L=null),P&&(r.productModal.removeEventListener("mousedown",P),P=null)}let S=null;function ct(){S=We,window.addEventListener("keydown",S)}function lt(){S&&(window.removeEventListener("keydown",S),S=null)}function dt(){r.closeOrderBtn?.addEventListener("click",je),r.backdropOrderModal?.addEventListener("mousedown",Ge)}function ut(){ye(),r.orderForm?.addEventListener("submit",he)}function pt(){r.themeToggle?.addEventListener("click",et)}
//# sourceMappingURL=index.js.map
