import{A as _,a as f,i as E,S as V,N as J,P as Q}from"./assets/vendor-0aAj9oPQ.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();const a={categories:document.querySelector("#categories"),products:document.querySelector("#products"),modal:document.querySelector(".modal"),modalProduct:document.querySelector(".modal-product"),loadMoreBtn:document.querySelector(".load-more-btn"),colorBox:document.querySelector(".products-color-list"),loader:document.querySelector(".loader"),feedbackCardList:document.querySelector(".feedback-card-list"),feedbackNavPrev:document.querySelector(".feedback-nav-prev"),feedbackNavNext:document.querySelector(".feedback-nav-next"),feedbackPaginationDots:document.querySelector(".feedback-pagination-dots"),feedbackSwiper:document.querySelector(".feedback-swiper")};function $(){setTimeout(()=>{a.loadMoreBtn.classList.add("is-show")},500)}function g(){a.loadMoreBtn.classList.remove("is-show")}function X(e){return e<1||e>5?e:e>=3.3&&e<=3.7?3.5:e>=3.8&&e<=4.2?4:Math.round(e*2)/2}function Y(e){const r=[{_id:"all",name:"Всі товари"},...e].map(({_id:o,name:s})=>`<li
        class="category-item" id="${o}"
        style="
          background-image: image-set(
            url('./furniture-bg/${o}.png') 1x,
            url('./furniture-bg/${o}@2x.png') 2x
          );
        "
      ><button class="categories-btn" type="button">${s}</button></li>`).join("");a.categories.innerHTML=r}function k(e){const t=e.map(({_id:r,name:o,images:s,price:n,color:c})=>`<li class="product-item" data-id="${r}">
        <img
          class="products-image"
          src='${s[0]}'
          alt="${o}"
        />
        <div class="product-description-box">
          <h4 class="products-title">${o}</h4>
          <ul class="products-color-list">
            ${c.map(w=>`<li class="products-color-box" style="background-color: ${w}"></li>`).join("")}
          </ul>
          <p class="products-price">${n} грн</p>
        </div>
        <button class="products-details-btn" type="button">Детальніше</button>
      </li>`).join("");a.products.insertAdjacentHTML("beforeend",t)}function Z(){a.products.innerHTML=""}new _(".accordion-container",{duration:300,showMultiple:!1});function ee(e){const t=e.rate??0,r=X(t),o=Math.max(0,Math.min(5,Math.floor(r))),s=r%1!==0,n=["feedback-rating","rating","small","star-icon","color-default",`value-${o}`];s&&n.push("half");const c=Array.from({length:5}).map(()=>`<div class="star icon default">
            <i class="star-empty"></i>
            <i class="star-half"></i>
            <i class="star-filled"></i>
          </div>`).join("");return`
    <li class="swiper-slide feedback-card-item">
      <div class="${n.join(" ")}" data-rating="${r}" aria-label="Рейтинг ${r} з 5">
        <div class="star-container">
          ${c}
        </div>
      </div>
      <p class="feedback-text">${e.descr||""}</p>
      <p class="feedback-author">${e.name||""}</p>
    </li>
  `}function te(e){if(!a.feedbackCardList)return;const t=e.map(r=>ee(r)).join("");a.feedbackCardList.innerHTML=t}const ae="https://furniture-store-v2.b.goit.study/api",N={FURNITURES:"/furnitures",CATEGORIES:"/categories",FEEDBACKS:"/feedbacks"},h=8,re=1,O=10;f.defaults.baseURL=ae;async function q(e=1){const{data:t}=await f(`${N.FURNITURES}?page=${e}&limit=${h}`);return t}async function H(e,t){const{data:r}=await f(`${N.FURNITURES}?page=${t}&limit=${h}&category=${e}`);return r}async function oe(){return(await f.get(N.CATEGORIES)).data}async function se(e={page:re,limit:O}){return(await f.get(N.FEEDBACKS,{params:e})).data}f.defaults.baseURL="https://furniture-store-v2.b.goit.study/api";const i=document.querySelector(".modal-window");let y=null,v=null;function ne(e=0){const t=Math.floor(e),r=e%1>=.5?1:0;let o="";for(let s=0;s<t;s++)o+='<span class="star star-full">★</span>';r&&(o+='<span class="star star-half">★</span>');for(let s=t+r;s<5;s++)o+='<span class="star star-empty">★</span>';return o}function ie(e){const t="https://furniture-store-v2.b.goit.study";return(e||[]).map(r=>typeof r=="string"&&r.startsWith("http")?r:`${t}${r}`)}function ce(){return{dialog:i.querySelector(".product-modalWindow"),mainImg:i.querySelector(".modal-image-0"),thumbsWrap:i.querySelector(".modal-bottom-row"),titleEl:i.querySelector(".product-modal-title"),catEl:i.querySelector(".modal-description"),priceEl:i.querySelector(".modal-price"),starsEl:i.querySelector(".modal-rating-stars"),colorsWrap:i.querySelector(".radio-group"),descEl:i.querySelector(".furnitureDescription"),sizeEl:i.querySelector(".furnitureSize"),btnClose:i.querySelector(".modal-close-btn"),orderBtn:i.querySelector(".modalButton")}}async function de(e){try{document.body.classList.add("modal-open"),i.classList.remove("visuallyhidden");const{data:t}=await f.get(`/furnitures/${e}`),{dialog:r,mainImg:o,thumbsWrap:s,titleEl:n,catEl:c,priceEl:w,starsEl:A,colorsWrap:B,descEl:x,sizeEl:T,btnClose:I,orderBtn:F}=ce(),R=ie(t.images||t.image||[]),D=R.length?R:["https://via.placeholder.com/640x360?text=No+Image"],W=D[0],K=D.slice(1,3);if(o&&(o.src=W,o.alt=t?.name||"photo"),s&&(s.innerHTML=K.map(d=>`<img class="modal-thumb" src="${d}" alt="${t?.name||"thumb"}">`).join(""),s.dataset.bound||(s.addEventListener("click",d=>{const l=d.target.closest(".modal-thumb");if(!l||!o)return;const P=o.src;o.src=l.src,l.src=P}),s.dataset.bound="1")),n&&(n.textContent=t?.name||""),c&&(c.textContent=t?.category?.name||"Без категорії"),w&&(w.textContent=`${t?.price??0} грн`),A&&(A.innerHTML=ne(t?.rate||0)),B){const d=Array.isArray(t?.color)?t.color:[];B.innerHTML=d.map((l,P)=>`<label><input type="radio" name="color" value="${l}" ${P===0?"checked":""}><span class="color-circle" style="background:${l}"></span></label>`).join("")}x&&(x.textContent=t?.description||"Опис відсутній"),T&&(T.textContent=`Розміри: ${t?.sizes||"—"}`),I&&(I.onclick=b),v=d=>{d.target===i&&b()},i.addEventListener("mousedown",v),y=d=>{d.key==="Escape"&&b()},document.addEventListener("keydown",y),F&&(F.onclick=()=>{const d=i.querySelector('input[name="color"]:checked'),l=d?d.value:null;b(),document.dispatchEvent(new CustomEvent("openOrderModal",{detail:{id:e,color:l}}))}),r&&(r.setAttribute("tabindex","-1"),r.focus({preventScroll:!0}))}catch(t){console.error("❌ Помилка завантаження товару",t),b()}}function b(){i.classList.add("visuallyhidden"),document.body.classList.remove("modal-open"),y&&(document.removeEventListener("keydown",y),y=null),v&&(i.removeEventListener("mousedown",v),v=null)}const S=document.querySelector(".backdrop");document.querySelector(".order-modal");const le=document.querySelector(".modal-close-btn");document.querySelector(".modal-submit-btn");const L=document.querySelector(".modal-order-form");async function ue(){S.classList.add("is-open"),document.body.classList.add("modal-open"),await new Promise(e=>setTimeout(e,300)),window.addEventListener("keydown",U)}async function M(){S.classList.remove("is-open"),document.body.classList.remove("modal-open"),await new Promise(e=>setTimeout(e,300)),window.removeEventListener("keydown",U)}le.addEventListener("click",async()=>{M()});S.addEventListener("click",async e=>{e.target===S&&await M()});function U(e){(e.key==="Escape"||e.key==="Esc")&&M()}L.addEventListener("submit",async e=>{e.preventDefault();const t=L.elements["user-name"].value.trim(),r=L.elements.phone.value.trim();if(!t||!r){E.warning({title:"Упс!",message:"Будь ласка, заповніть всі обов'язкові поля!",position:"topRight"});return}const o=r.replace(/[^\d+]/g,"");if(!/^\+?\d{10,15}$/.test(o)){E.warning({title:"Упс!",message:"Будь ласка, введіть коректний номер телефону",position:"topRight"});return}try{await new Promise(n=>setTimeout(n,500)),E.success({title:"Успішно!",message:"Ваше замовлення відправлено!",position:"topRight"}),L.reset(),await M()}catch{E.error({title:"Помилка!",message:"Щось пішло не так. Спробуйте ще раз.",position:"topRight"})}});document.querySelector(".open-modal-btn")?.addEventListener("click",async()=>{await ue()});let m=1,p="";async function j(){try{const e=await oe();Y(e),p="all",a.categories.children[0].classList.add("categories-item--active");const{furnitures:r}=await q();k(r),$()}catch{}finally{}}async function z(e){const t=e.target.closest(".category-item");if(!t)return;[...e.currentTarget.children].map(o=>{o.classList.remove("categories-item--active")}),Z(),t.classList.add("categories-item--active"),m=1,p=t.id;try{if(p==="all"){const{furnitures:o}=await q();k(o),$()}else{const{furnitures:o,totalItems:s}=await H(p,m);if(o.length)s<h&&g(),k(o);else{g();return}}}catch{}finally{}}async function G(e){e.preventDefault(),m++;try{if(p==="all"){const{furnitures:t,totalItems:r}=await q(m);r<h*m?g():$(),k(t)}else{const{furnitures:t,totalItems:r}=await H(p,m);if(t.length)r<h&&g(),k(t);else{g();return}}}catch{}finally{}}const fe=e=>{const t=e.target.closest(".products-details-btn");if(!t)return;const r=t.closest(".product-item");if(!r)return;let o=r.dataset.id;if(!o){const c=(r.querySelector('img[src*="/furniture/"]')?.getAttribute("src")||"").match(/\/([a-f0-9]{24})_/i);c&&(o=c[1])}if(!o){console.warn("Не знайдено id товару для модалки");return}e.preventDefault(),de(o)};let u=null;function me(e=10){if(!(!a.feedbackSwiper||!a.feedbackCardList))return u&&(u.destroy(!0,!0),u=null),u=new V(a.feedbackSwiper,{modules:[J,Q],slidesPerView:1,slidesPerGroup:1,spaceBetween:24,loop:!1,grabCursor:!0,allowTouchMove:!0,touchRatio:1,simulateTouch:!0,watchSlidesProgress:!0,navigation:{nextEl:a.feedbackNavNext,prevEl:a.feedbackNavPrev},pagination:{el:a.feedbackPaginationDots,clickable:!0,bulletClass:"feedback-pagination-dot",bulletActiveClass:"active",type:"bullets",dynamicBullets:!1},breakpoints:{375:{slidesPerView:1,slidesPerGroup:1,spaceBetween:16},768:{slidesPerView:2,slidesPerGroup:1,spaceBetween:24},1200:{slidesPerView:3,slidesPerGroup:1,spaceBetween:24}},on:{init:function(){C()},slideChange:function(){C()},resize:function(){C()}}}),u}function C(){if(!u||!a.feedbackNavPrev||!a.feedbackNavNext)return;const e=u.isBeginning,t=u.isEnd;e?(a.feedbackNavPrev.setAttribute("disabled","true"),a.feedbackNavPrev.classList.add("disabled"),a.feedbackNavPrev.setAttribute("aria-disabled","true")):(a.feedbackNavPrev.removeAttribute("disabled"),a.feedbackNavPrev.classList.remove("disabled"),a.feedbackNavPrev.setAttribute("aria-disabled","false")),t?(a.feedbackNavNext.setAttribute("disabled","true"),a.feedbackNavNext.classList.add("disabled"),a.feedbackNavNext.setAttribute("aria-disabled","true")):(a.feedbackNavNext.removeAttribute("disabled"),a.feedbackNavNext.classList.remove("disabled"),a.feedbackNavNext.setAttribute("aria-disabled","false"))}async function pe(){try{const t=(await se({limit:O})).feedbacks||[];if(t.length===0){console.warn("No feedbacks received from API");return}te(t),setTimeout(()=>{me(t.length)},50)}catch(e){console.error("Error loading feedbacks:",e)}}async function be(){if(!a.feedbackSwiper||!a.feedbackCardList||!a.feedbackNavPrev||!a.feedbackNavNext||!a.feedbackPaginationDots){console.warn("Feedback section elements not found in DOM");return}await pe()}document.addEventListener("DOMContentLoaded",j);document.addEventListener("DOMContentLoaded",()=>{be()});a.categories.addEventListener("click",z);a.loadMoreBtn.addEventListener("click",G);window.addEventListener("load",()=>{requestAnimationFrame(()=>{window.scrollTo({top:0,left:0,behavior:"auto"})})});document.addEventListener("DOMContentLoaded",()=>{j(),a.categories&&!a.categories.dataset.bound&&(a.categories.addEventListener("click",z),a.categories.dataset.bound="1"),a.loadMoreBtn&&!a.loadMoreBtn.dataset.bound&&(a.loadMoreBtn.addEventListener("click",G),a.loadMoreBtn.dataset.bound="1");const e=a.products||document.getElementById("products");e&&e.dataset.boundModal!=="1"&&(e.addEventListener("click",fe),e.dataset.boundModal="1")});
//# sourceMappingURL=index.js.map
