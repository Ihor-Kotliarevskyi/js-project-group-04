import{A as G,a as f,i as S,R as z,S as _,N as j,P as K}from"./assets/vendor-lXkXHKPV.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();const T=document.querySelector(".order-modal"),i=document.querySelector(".modal-window"),o={categories:document.querySelector("#categories"),products:document.querySelector("#products"),loadMoreBtn:document.querySelector(".load-more-btn"),feedbackCardList:document.querySelector(".feedback-card-list"),feedbackNavPrev:document.querySelector(".feedback-nav-prev"),feedbackNavNext:document.querySelector(".feedback-nav-next"),feedbackPaginationDots:document.querySelector(".feedback-pagination-dots"),feedbackSwiper:document.querySelector(".feedback-swiper"),loader:document.querySelector(".backdrope-loader"),backdropOrderModal:document.querySelector(".backdrop"),modalOrder:T,closeOrderBtn:T?.querySelector(".modal-close-btn"),submitBtn:T?.querySelector(".modal-submit-btn"),orderForm:T?.querySelector(".modal-order-form"),productModal:i,productModalDialog:i?.querySelector(".product-modalWindow"),productModalMainImg:i?.querySelector(".modal-image-0"),productModalThumbsWrap:i?.querySelector(".modal-bottom-row"),productModalTitle:i?.querySelector(".product-modal-title"),productModalCategory:i?.querySelector(".modal-description"),productModalPrice:i?.querySelector(".modal-price"),productModalStars:i?.querySelector(".modal-rating-stars"),productModalColorsWrap:i?.querySelector(".radio-group"),productModalDescription:i?.querySelector(".furnitureDescription"),productModalSize:i?.querySelector(".furnitureSize"),productModalCloseBtn:i?.querySelector(".modal-close-btn"),productModalOrderBtn:i?.querySelector(".modalButton"),burgerMenuOpenBtn:document.querySelector("[data-menu-open]"),burgerMenu:document.querySelector(".burger-menu"),burgerMenuHeaderNav:document.querySelector(".header-nav"),burgerMenuHeaderButton:document.querySelector(".burger-menu-header-button"),body:document.body,themeToggle:document.querySelector("[data-theme-toggle]")};function V(e){const r=[{_id:"all",name:"Всі товари"},...e].map(({_id:n,name:a})=>`<li
        class="category-item" id="${n}"
        style="
          background-image: image-set(
            url('./furniture-bg/${n}.png') 1x,
            url('./furniture-bg/${n}@2x.png') 2x
          );
        "
      ><button class="categories-btn" type="button">${a}</button></li>`).join("");o.categories.innerHTML=r}function E(e){const t=e.map(({_id:r,name:n,images:a,price:s,color:c})=>`<li class="product-item" data-id="${r}">
        <img
          class="products-image"
          src='${a[0]}'
          alt="${n}"
        />
        <div class="product-description-box">
          <h4 class="products-title">${n}</h4>
          <ul class="products-color-list">
            ${c.map(d=>`<li class="products-color-box" style="background-color: ${d}"></li>`).join("")}
          </ul>
          <p class="products-price">${s} грн</p>
        </div>
        <button class="products-details-btn" type="button">Детальніше</button>
      </li>`).join("");o.products.insertAdjacentHTML("beforeend",t)}function Y(){o.products.innerHTML=""}new G(".accordion-container",{duration:300,showMultiple:!1,beforeOpen:e=>{const t=e.querySelector(".ac-icon");t&&(t.style.transform="translateY(-50%) rotate(180deg)")},beforeClose:e=>{const t=e.querySelector(".ac-icon");t&&(t.style.transform="translateY(-50%) rotate(0deg)")}});const J="https://furniture-store-v2.b.goit.study/api",B={FURNITURES:"/furnitures",CATEGORIES:"/categories",FEEDBACKS:"/feedbacks",ORDERS:"/orders"},Q=1,L=8,Z=1,X=10,ee=e=>`/furnitures/${e}`;f.defaults.baseURL=J;async function te(){return(await f.get(B.CATEGORIES)).data}async function $(e=Q){const{data:t}=await f(`${B.FURNITURES}?page=${e}&limit=${L}`);return t}async function U(e,t){const{data:r}=await f(`${B.FURNITURES}?page=${t}&limit=${L}&category=${e}`);return r}async function re(e){const t=ee(e);return(await f.get(t)).data}async function oe(e={page:Z,limit:X}){return(await f.get(B.FEEDBACKS,{params:e})).data}async function ne(e){return(await f.post(B.ORDERS,e)).data}function D(){setTimeout(()=>{o.loadMoreBtn.classList.add("is-show")},500)}function p(){o.loadMoreBtn.classList.remove("is-show")}function ae(e){return e<1||e>5?e:e>=3.3&&e<=3.7?3.5:e>=3.8&&e<=4.2?4:Math.round(e*2)/2}S.settings({position:"topRight",displayMode:"replace",timeout:4e3,progressBar:!1});function h(e){S.info({message:e})}function se(e){S.success({message:e})}function l(e){S.warning({message:e})}function y(e){S.error({message:e.message})}function C(){o.loader.classList.remove("hidden"),p()}function N(){o.loader.classList.add("hidden")}let R=null,W=null;function ce(){localStorage.removeItem("order-form")}function ie(e,t){if(!e||!t)return l("Please fill in your name and phone number."),!1;if(!R)return l("Choose a product before ordering."),!1;let r=t.replace(/\D/g,"");return r.length<10?(l("Enter a valid phone number (at least 10 digits)."),!1):(r.startsWith("0")&&(r="38"+r),r.length!==12&&!r.match(/^\d{10,15}$/)?(l("Enter a valid phone number in format: +38 (0XX) XXX-XX-XX or 380XXXXXXXXX"),!1):r.length===12&&r.match(/^\d{12}$/)?r:r.length>=10&&r.length<=15?r.length>12?r.substring(0,12):r:(l("Enter a valid phone number."),!1))}function de(){o.orderForm.querySelectorAll("input, textarea").forEach(e=>{e.addEventListener("input",()=>{const t={};o.orderForm.querySelectorAll("input, textarea").forEach(r=>{r.name&&(t[r.name]=r.value)}),localStorage.setItem("order-form",JSON.stringify(t))})})}async function le(e){e.preventDefault();const t=o.orderForm.elements["user-name"]?.value.trim(),r=o.orderForm.elements["user-phone"]?.value.trim();o.orderForm.elements["user-comment"]?.value.trim();const n=ie(t,r);if(!n)return;const a={name:t,phone:n,comment:"empty",modelId:R,color:W};o.submitBtn.disabled=!0;try{C(),await ne(a),se("Your order has been sent!"),o.orderForm.reset(),ce(),A()}catch(s){y(s)}finally{N(),o.submitBtn.disabled=!1}}async function ue(e,t,r){document.body.classList.add("modal-open"),R=e??null,W=r??null,o.backdropOrderModal.classList.add("is-open"),fe(),Ye()}async function A(){document.body.classList.remove("modal-open"),o.backdropOrderModal.classList.remove("is-open"),Je()}function fe(){const e=localStorage.getItem("order-form");if(e)try{const t=JSON.parse(e);o.orderForm.querySelectorAll("input, textarea").forEach(r=>{r.name&&t[r.name]!==void 0&&(r.value=t[r.name])})}catch(t){console.error("Помилка при відновленні даних форми:",t)}}function me(e=0){const t=Math.floor(e),r=e%1>=.5?1:0;let n="";for(let a=0;a<t;a++)n+='<span class="star star-full">★</span>';r&&(n+='<span class="star star-half">★</span>');for(let a=t+r;a<5;a++)n+='<span class="star star-empty">★</span>';return n}function pe(e){const t="https://furniture-store-v2.b.goit.study";return(e||[]).map(r=>typeof r=="string"&&r.startsWith("http")?r:`${t}${r}`)}function be(){return{dialog:o.productModalDialog,mainImg:o.productModalMainImg,thumbsWrap:o.productModalThumbsWrap,titleEl:o.productModalTitle,catEl:o.productModalCategory,priceEl:o.productModalPrice,starsEl:o.productModalStars,colorsWrap:o.productModalColorsWrap,descEl:o.productModalDescription,sizeEl:o.productModalSize,btnClose:o.productModalCloseBtn,orderBtn:o.productModalOrderBtn}}function ge(e,t,r,n){if(!e||!t)return;const a=r.length?r:["https://via.placeholder.com/640x360?text=No+Image"],s=a[0],c=a.slice(1,3);e.src=s,e.alt=n||"photo",t.innerHTML=c.map(d=>`<img class="modal-thumb" src="${d}" alt="${n||"thumb"}">`).join("")}function ye(e,t){if(!e)return;const r=Array.isArray(t)?t:[];e.innerHTML=r.map((n,a)=>`<label>
          <input type="radio" name="color" value="${n}" ${a===0?"checked":""}>
          <span class="color-circle" style="background:${n}"></span>
        </label>`).join("")}function he(e,t){const{titleEl:r,catEl:n,priceEl:a,starsEl:s,descEl:c,sizeEl:d}=e;r&&(r.textContent=t?.name||""),n&&(n.textContent=t?.category?.name||"Без категорії"),a&&(a.textContent=`${t?.price??0} грн`),s&&(s.innerHTML=me(t?.rate||0)),c&&(c.textContent=t?.description||"Опис відсутній"),d&&(d.textContent=`Розміри: ${t?.sizes||"—"}`)}async function ve(e){try{C(),document.body.classList.add("modal-open"),o.productModal.classList.remove("visuallyhidden");const t=await re(e),r=be(),n=pe(t.images||t.image||[]);ge(r.mainImg,r.thumbsWrap,n,t?.name),he(r,t),ye(r.colorsWrap,t?.color),Ke(r,e)}catch(t){y(t)}finally{N()}}function I(){o.productModal.classList.add("visuallyhidden"),document.body.classList.remove("modal-open"),Ve()}let m=1,b="";async function Me(){try{C();const e=await te();V(e),b="all",o.categories.children[0].classList.add("categories-item--active");const{furnitures:r}=await $();E(r),D()}catch(e){y(e)}finally{N()}}async function ke(e){const t=e.target.closest(".category-item");if(!t)return;[...e.currentTarget.children].map(n=>{n.classList.remove("categories-item--active")}),Y(),t.classList.add("categories-item--active"),m=1,b=t.id,C();try{if(b==="all"){const{furnitures:n}=await $();E(n),D()}else{const{furnitures:n,totalItems:a}=await U(b,m);if(n.length)a<L&&(p(),h(`Ended furnitures collections in "${t.textContent}" categories`)),E(n);else{p(),h(`Furnitures in "${t.textContent}" categories is not found`);return}}}catch(n){y(n)}finally{N()}}async function Ee(e){e.preventDefault(),m++,C();try{if(b==="all"){const{furnitures:t,totalItems:r}=await $(m);r<L*m?(p(),h("End collections")):D(),E(t)}else{const{furnitures:t,totalItems:r}=await U(b,m);if(t.length)r<L&&(p(),h("End collections")),E(t);else{p(),h("Furnitures is not found");return}}}catch(t){y(t)}finally{N()}}const Le=e=>{const t=e.target.closest(".products-details-btn");if(!t)return;const r=t.closest(".product-item");if(!r)return;let n=r.dataset.id;if(!n){const c=(r.querySelector('img[src*="/furniture/"]')?.getAttribute("src")||"").match(/\/([a-f0-9]{24})_/i);c&&(n=c[1])}if(!n){l("ID not found");return}e.preventDefault(),ve(n)};function we(){requestAnimationFrame(()=>{window.scrollTo({top:0,left:0,behavior:"auto"})})}function Se(e,t,r,n){e.classList.add("is-open"),t.classList.add("no-scroll"),r.style.display="none",n.style.display="flex"}function Be(e,t,r,n){e.classList.remove("is-open"),t.classList.remove("no-scroll"),r.style.display="flex",n.style.display="none"}function Ce(e,t,r){e.key==="Escape"&&t.classList.contains("is-open")&&r()}function Ne(e){e.target===o.productModal&&I()}function Pe(e){e.key==="Escape"&&I()}function Te(e){const t=o.productModal.querySelector('input[name="color"]:checked'),r=t?t.value:null;I(),ue(e,null,r)}function Ae(e,t){const r=e.target.closest(".modal-thumb");if(!r||!t)return;const n=t.src;t.src=r.src,r.src=n}function Ie(e){e.key==="Escape"&&A()}function Oe(){A()}function qe(e){e.target===o.backdropOrderModal&&A()}let u=null;function Fe(e=10){if(!(!o.feedbackSwiper||!o.feedbackCardList))return u&&(u.destroy(!0,!0),u=null),u=new _(o.feedbackSwiper,{modules:[j,K],slidesPerView:1,slidesPerGroup:1,spaceBetween:24,loop:!1,grabCursor:!0,allowTouchMove:!0,touchRatio:1,simulateTouch:!0,watchSlidesProgress:!0,navigation:{nextEl:o.feedbackNavNext,prevEl:o.feedbackNavPrev},pagination:{el:o.feedbackPaginationDots,clickable:!0,bulletClass:"feedback-pagination-dot",bulletActiveClass:"active",type:"bullets",dynamicBullets:!1},breakpoints:{375:{slidesPerView:1,slidesPerGroup:1,spaceBetween:16},768:{slidesPerView:2,slidesPerGroup:1,spaceBetween:24},1200:{slidesPerView:3,slidesPerGroup:1,spaceBetween:24}},on:{init:function(){q()},slideChange:function(){q()},resize:function(){q()}}}),u}function q(){if(!u||!o.feedbackNavPrev||!o.feedbackNavNext)return;const e=u.isBeginning,t=u.isEnd;e?(o.feedbackNavPrev.setAttribute("disabled","true"),o.feedbackNavPrev.classList.add("disabled"),o.feedbackNavPrev.setAttribute("aria-disabled","true")):(o.feedbackNavPrev.removeAttribute("disabled"),o.feedbackNavPrev.classList.remove("disabled"),o.feedbackNavPrev.setAttribute("aria-disabled","false")),t?(o.feedbackNavNext.setAttribute("disabled","true"),o.feedbackNavNext.classList.add("disabled"),o.feedbackNavNext.setAttribute("aria-disabled","true")):(o.feedbackNavNext.removeAttribute("disabled"),o.feedbackNavNext.classList.remove("disabled"),o.feedbackNavNext.setAttribute("aria-disabled","false"))}async function xe(){try{const t=(await oe({limit:X})).feedbacks||[];if(t.length===0){l("No feedbacks received from API");return}Re(t),setTimeout(()=>{Fe(t.length)},50)}catch(e){y(e)}}async function $e(){if(!o.feedbackSwiper||!o.feedbackCardList||!o.feedbackNavPrev||!o.feedbackNavNext||!o.feedbackPaginationDots){l("Feedback section elements not found in DOM");return}await xe()}function De(e){const t=e.rate??0,r=ae(t);return`
    <li class="swiper-slide feedback-card-item">
      <div class="feedback-rating" data-score="${r}" aria-label="Рейтинг ${r} з 5"></div>
      <p class="feedback-text">${e.descr||""}</p>
      <p class="feedback-author">${e.name||""}</p>
    </li>
  `}function Re(e){if(!o.feedbackCardList)return;const t=e.map(n=>De(n)).join("");o.feedbackCardList.innerHTML=t,o.feedbackCardList.querySelectorAll(".feedback-rating").forEach(n=>{const a=Number(n.dataset.score)||0;n.innerHTML="",new z(n,{readOnly:!0,starType:"i",number:5,score:a,half:!0,halfShow:!0,starOn:"feedback-star-on",starOff:"feedback-star-off",starHalf:"feedback-star-half",space:!1}).init()})}const F="theme",w="light",g="dark";function He(){const e=localStorage.getItem(F);return e||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?g:w)}function x(e){e===g?(document.documentElement.setAttribute("data-theme",g),localStorage.setItem(F,g),H(!0)):(document.documentElement.setAttribute("data-theme",w),localStorage.setItem(F,w),H(!1))}function Xe(){return document.documentElement.getAttribute("data-theme")||w}function H(e){const t=o.themeToggle;if(!t)return;const r=t.querySelector(".theme-icon-sun"),n=t.querySelector(".theme-icon-moon");e?(r&&(r.style.display="none"),n&&(n.style.display="block")):(r&&(r.style.display="block"),n&&(n.style.display="none"))}function Ue(){const e=Xe();x(e===g?w:g)}function We(){const e=He();x(e)}window.addEventListener("load",we);document.addEventListener("DOMContentLoaded",()=>{We(),Me(),$e(),je(),_e(),Ge(),ze(),Qe(),Ze(),et()});function Ge(){o.categories&&!o.categories.dataset.bound&&(o.categories.addEventListener("click",ke),o.categories.dataset.bound="1")}function ze(){o.loadMoreBtn&&!o.loadMoreBtn.dataset.bound&&(o.loadMoreBtn.addEventListener("click",Ee),o.loadMoreBtn.dataset.bound="1")}function _e(){const e=o.products||document.getElementById("products");e&&e.dataset.boundModal!=="1"&&(e.addEventListener("click",Le),e.dataset.boundModal="1")}function je(){const e=o.burgerMenuOpenBtn,t=o.burgerMenu,r=o.burgerMenuHeaderNav,n=o.burgerMenuHeaderButton,a=o.body;if(!e||!t||!r){console.warn("Не знайдено елементи меню або хедеру");return}const s=document.createElement("button");s.classList.add("burger-menu-navbar-btn-close"),s.setAttribute("type","button"),s.setAttribute("data-navbar-close","");const c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.classList.add("burger-button-icon"),c.setAttribute("width","32"),c.setAttribute("height","32");const d=document.createElementNS("http://www.w3.org/2000/svg","use");d.setAttributeNS("http://www.w3.org/1999/xlink","href","/img/sprite.svg#x"),c.appendChild(d),s.appendChild(c),e.insertAdjacentElement("beforebegin",s);const P=()=>{Be(t,a,e,s)};e.addEventListener("click",()=>{Se(t,a,e,s)}),s.addEventListener("click",P),n?.addEventListener("click",P),t.querySelectorAll(".nav-link").forEach(O=>O.addEventListener("click",P)),document.addEventListener("keydown",O=>{Ce(O,t,P)}),s.style.display="none"}let v=null,M=null;function Ke(e,t){const{btnClose:r,orderBtn:n,dialog:a,thumbsWrap:s,mainImg:c}=e;r&&(r.onclick=I),M=Ne,o.productModal.addEventListener("mousedown",M),v=Pe,document.addEventListener("keydown",v),n&&(n.onclick=()=>Te(t)),s&&!s.dataset.bound&&(s.addEventListener("click",d=>{Ae(d,c)}),s.dataset.bound="1"),a&&(a.setAttribute("tabindex","-1"),a.focus({preventScroll:!0}))}function Ve(){v&&(document.removeEventListener("keydown",v),v=null),M&&(o.productModal.removeEventListener("mousedown",M),M=null)}let k=null;function Ye(){k=Ie,window.addEventListener("keydown",k)}function Je(){k&&(window.removeEventListener("keydown",k),k=null)}function Qe(){o.closeOrderBtn?.addEventListener("click",Oe),o.backdropOrderModal?.addEventListener("mousedown",qe)}function Ze(){de(),o.orderForm?.addEventListener("submit",le)}function et(){o.themeToggle?.addEventListener("click",Ue)}
//# sourceMappingURL=index.js.map
