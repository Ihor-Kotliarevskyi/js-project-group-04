import{i as N,A as Z,R as ee,a as p,S as te,N as re,P as ne}from"./assets/vendor-Br7U2jgC.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const P=document.querySelector(".order-modal"),r={categories:document.querySelector("#categories"),products:document.querySelector("#products"),loadMoreBtn:document.querySelector(".load-more-btn"),feedbackCardList:document.querySelector(".feedback-card-list"),feedbackNavPrev:document.querySelector(".feedback-nav-prev"),feedbackNavNext:document.querySelector(".feedback-nav-next"),feedbackPaginationDots:document.querySelector(".feedback-pagination-dots"),feedbackSwiper:document.querySelector(".feedback-swiper"),loader:document.querySelector(".backdrope-loader"),backdropOrderModal:document.querySelector(".backdrop"),modalOrder:P,closeOrderBtn:P.querySelector(".modal-close-btn"),submitBtn:P.querySelector(".modal-submit-btn"),orderForm:P.querySelector(".modal-order-form")};function F(){setTimeout(()=>{r.loadMoreBtn.classList.add("is-show")},500)}function h(){r.loadMoreBtn.classList.remove("is-show")}function ae(e){return e<1||e>5?e:e>=3.3&&e<=3.7?3.5:e>=3.8&&e<=4.2?4:Math.round(e*2)/2}N.settings({position:"topRight",displayMode:"replace",timeout:6e3,progressBar:!1});function L(e){N.info({message:e})}function oe(e){N.success({message:e})}function y(e){N.warning({message:e})}function k(e){N.error({message:e})}function q(){r.loader.classList.remove("hidden")}function O(){r.loader.classList.add("hidden")}function se(e){const a=[{_id:"all",name:"Всі товари"},...e].map(({_id:n,name:o})=>`<li
        class="category-item" id="${n}"
        style="
          background-image: image-set(
            url('./furniture-bg/${n}.png') 1x,
            url('./furniture-bg/${n}@2x.png') 2x
          );
        "
      ><button class="categories-btn" type="button">${o}</button></li>`).join("");r.categories.innerHTML=a}function S(e){const t=e.map(({_id:a,name:n,images:o,price:s,color:i})=>`<li class="product-item" data-id="${a}">
        <img
          class="products-image"
          src='${o[0]}'
          alt="${n}"
        />
        <div class="product-description-box">
          <h4 class="products-title">${n}</h4>
          <ul class="products-color-list">
            ${i.map(l=>`<li class="products-color-box" style="background-color: ${l}"></li>`).join("")}
          </ul>
          <p class="products-price">${s} грн</p>
        </div>
        <button class="products-details-btn" type="button">Детальніше</button>
      </li>`).join("");r.products.insertAdjacentHTML("beforeend",t)}function ie(){r.products.innerHTML=""}new Z(".accordion-container",{duration:300,showMultiple:!1,beforeOpen:e=>{const t=e.querySelector(".ac-icon");t&&(t.style.transform="rotate(180deg)")},beforeClose:e=>{const t=e.querySelector(".ac-icon");t&&(t.style.transform="rotate(0deg)")}});function ce(e){const t=e.rate??0,a=ae(t);return`
    <li class="swiper-slide feedback-card-item">
      <div class="feedback-rating" data-score="${a}" aria-label="Рейтинг ${a} з 5"></div>
      <p class="feedback-text">${e.descr||""}</p>
      <p class="feedback-author">${e.name||""}</p>
    </li>
  `}function de(e){if(!r.feedbackCardList)return;const t=e.map(n=>ce(n)).join("");r.feedbackCardList.innerHTML=t,r.feedbackCardList.querySelectorAll(".feedback-rating").forEach(n=>{const o=Number(n.dataset.score)||0;n.innerHTML="",new ee(n,{readOnly:!0,starType:"i",number:5,score:o,half:!0,halfShow:!0,starOn:"feedback-star-on",starOff:"feedback-star-off",starHalf:"feedback-star-half",space:!1}).init()})}const le="https://furniture-store-v2.b.goit.study/api",B={FURNITURES:"/furnitures",CATEGORIES:"/categories",FEEDBACKS:"/feedbacks"},ue=1,M=8,fe=1,W=10;p.defaults.baseURL=le;async function me(){return(await p.get(B.CATEGORIES)).data}async function T(e=ue){const{data:t}=await p(`${B.FURNITURES}?page=${e}&limit=${M}`);return t}async function _(e,t){const{data:a}=await p(`${B.FURNITURES}?page=${t}&limit=${M}&category=${e}`);return a}async function pe(e={page:fe,limit:W}){return(await p.get(B.FEEDBACKS,{params:e})).data}p.defaults.baseURL="https://furniture-store-v2.b.goit.study/api";const b=document.querySelector(".modal-window");let E=null,w=null;function be(e=0){const t=Math.floor(e),a=e%1>=.5?1:0;let n="";for(let o=0;o<t;o++)n+='<span class="star star-full">★</span>';a&&(n+='<span class="star star-half">★</span>');for(let o=t+a;o<5;o++)n+='<span class="star star-empty">★</span>';return n}function ge(e){const t="https://furniture-store-v2.b.goit.study";return(e||[]).map(a=>typeof a=="string"&&a.startsWith("http")?a:`${t}${a}`)}function d(e,t){return e.querySelector(t)}function ye(e){return{dialog:d(e,".product-modalWindow"),mainImg:d(e,".modal-image-0"),thumbsWrap:d(e,".modal-bottom-row"),titleEl:d(e,".product-modal-title"),catEl:d(e,".modal-description"),priceEl:d(e,".modal-price"),starsEl:d(e,".modal-rating-stars"),colorsWrap:d(e,".radio-group"),descEl:d(e,".furnitureDescription"),sizeEl:d(e,".furnitureSize"),btnClose:d(e,".modal-close-btn"),orderBtn:d(e,".modalButton")}}async function ve(e){try{document.body.classList.add("modal-open"),b.classList.remove("visuallyhidden");const{data:t}=await p.get(`/furnitures/${e}`),{dialog:a,mainImg:n,thumbsWrap:o,titleEl:s,catEl:i,priceEl:l,starsEl:u,colorsWrap:D,descEl:R,sizeEl:H,btnClose:U,orderBtn:j}=ye(b),G=ge(t.images||t.image||[]),z=G.length?G:["https://via.placeholder.com/640x360?text=No+Image"],Q=z[0],X=z.slice(1,3);if(n&&(n.src=Q,n.alt=t?.name||"photo"),o&&(o.innerHTML=X.map(c=>`<img class="modal-thumb" src="${c}" alt="${t?.name||"thumb"}">`).join(""),o.dataset.bound||(o.addEventListener("click",c=>{const f=c.target.closest(".modal-thumb");if(!f||!n)return;const x=n.src;n.src=f.src,f.src=x}),o.dataset.bound="1")),s&&(s.textContent=t?.name||""),i&&(i.textContent=t?.category?.name||"Без категорії"),l&&(l.textContent=`${t?.price??0} грн`),u&&(u.innerHTML=be(t?.rate||0)),R&&(R.textContent=t?.description||"Опис відсутній"),H&&(H.textContent=`Розміри: ${t?.sizes||"—"}`),D){const c=Array.isArray(t?.color)?t.color:[];D.innerHTML=c.map((f,x)=>`<label><input type="radio" name="color" value="${f}" ${x===0?"checked":""}><span class="color-circle" style="background:${f}"></span></label>`).join("")}U&&(U.onclick=A),w=c=>{c.target===b&&A()},b.addEventListener("mousedown",w),E=c=>{c.key==="Escape"&&A()},document.addEventListener("keydown",E),j&&(j.onclick=()=>{const c=b.querySelector('input[name="color"]:checked'),f=c?c.value:null;ke(e,null,f),A()}),a&&(a.setAttribute("tabindex","-1"),a.focus({preventScroll:!0}))}catch(t){k(t)}}function A(){b.classList.add("visuallyhidden"),document.body.classList.remove("modal-open"),E&&(document.removeEventListener("keydown",E),E=null),w&&(b.removeEventListener("mousedown",w),w=null)}r.closeOrderBtn.addEventListener("click",async()=>{await C()});let $=null,K=null;function V(e){e.key==="Escape"&&C()}async function ke(e,t,a){$=e??null,K=a??null,r.backdropOrderModal.classList.add("is-open"),document.body.classList.add("modal-open"),window.addEventListener("keydown",V),r.orderForm.querySelectorAll("input, textarea").forEach(n=>{const o=localStorage.getItem(n.name);o&&(n.value=o)})}async function C(){r.backdropOrderModal.classList.remove("is-open"),document.body.classList.remove("modal-open"),window.removeEventListener("keydown",V)}r.closeOrderBtn?.addEventListener("click",()=>C());r.backdropOrderModal?.addEventListener("mousedown",e=>{e.target===r.backdropOrderModal&&C()});r.orderForm?.addEventListener("submit",async e=>{e.preventDefault();const t=r.orderForm.elements["user-name"]?.value.trim(),a=r.orderForm.elements["user-phone"]?.value.trim(),n=r.orderForm.elements["user-comment"]?.value.trim()||"";if(!t||!a){y("Please fill in your name and phone number.");return}if(!$){y("Choose a product before ordering.");return}const o=a.replace(/[^\d+]/g,"");if(!/^\+?\d{10,15}$/.test(o)){y("Enter a valid phone number.");return}const i={name:t,phone:o,comment:n,modelId:$,color:K};r.submitBtn.disabled=!0;try{const l=await p.post("/orders",i);oe("Your order has been sent!"),r.orderForm.reset(),r.orderForm.querySelectorAll("input, textarea").forEach(u=>localStorage.removeItem(u.name)),C()}catch(l){k(l)}finally{r.submitBtn.disabled=!1}});r.orderForm?.querySelectorAll("input, textarea").forEach(e=>{e.addEventListener("input",t=>{const a=t.target;localStorage.setItem(a.name,a.value)})});let g=1,v="";async function he(){try{q();const e=await me();se(e),v="all",r.categories.children[0].classList.add("categories-item--active");const{furnitures:a}=await T();S(a),F()}catch(e){k(e)}finally{O()}}async function Y(e){const t=e.target.closest(".category-item");if(!t)return;[...e.currentTarget.children].map(n=>{n.classList.remove("categories-item--active")}),ie(),t.classList.add("categories-item--active"),g=1,v=t.id,q();try{if(v==="all"){const{furnitures:n}=await T();S(n),F()}else{const{furnitures:n,totalItems:o}=await _(v,g);if(n.length)o<M&&(h(),L(`Ended furnitures collections in "${t.textContent}" categories`)),S(n);else{h(),L(`Furnitures in "${t.textContent}" categories is not found`);return}}}catch(n){k(n)}finally{O()}}async function J(e){e.preventDefault(),g++,q();try{if(v==="all"){const{furnitures:t,totalItems:a}=await T(g);a<M*g?(h(),L("End collections")):F(),S(t)}else{const{furnitures:t,totalItems:a}=await _(v,g);if(t.length)a<M&&(h(),L("End collections")),S(t);else{h(),L("Furnitures is not found");return}}}catch(t){k(t)}finally{O()}}const Le=e=>{const t=e.target.closest(".products-details-btn");if(!t)return;const a=t.closest(".product-item");if(!a)return;let n=a.dataset.id;if(!n){const i=(a.querySelector('img[src*="/furniture/"]')?.getAttribute("src")||"").match(/\/([a-f0-9]{24})_/i);i&&(n=i[1])}if(!n){y("ID not found");return}e.preventDefault(),ve(n)};let m=null;function Ee(e=10){if(!(!r.feedbackSwiper||!r.feedbackCardList))return m&&(m.destroy(!0,!0),m=null),m=new te(r.feedbackSwiper,{modules:[re,ne],slidesPerView:1,slidesPerGroup:1,spaceBetween:24,loop:!1,grabCursor:!0,allowTouchMove:!0,touchRatio:1,simulateTouch:!0,watchSlidesProgress:!0,navigation:{nextEl:r.feedbackNavNext,prevEl:r.feedbackNavPrev},pagination:{el:r.feedbackPaginationDots,clickable:!0,bulletClass:"feedback-pagination-dot",bulletActiveClass:"active",type:"bullets",dynamicBullets:!1},breakpoints:{375:{slidesPerView:1,slidesPerGroup:1,spaceBetween:16},768:{slidesPerView:2,slidesPerGroup:1,spaceBetween:24},1200:{slidesPerView:3,slidesPerGroup:1,spaceBetween:24}},on:{init:function(){I()},slideChange:function(){I()},resize:function(){I()}}}),m}function I(){if(!m||!r.feedbackNavPrev||!r.feedbackNavNext)return;const e=m.isBeginning,t=m.isEnd;e?(r.feedbackNavPrev.setAttribute("disabled","true"),r.feedbackNavPrev.classList.add("disabled"),r.feedbackNavPrev.setAttribute("aria-disabled","true")):(r.feedbackNavPrev.removeAttribute("disabled"),r.feedbackNavPrev.classList.remove("disabled"),r.feedbackNavPrev.setAttribute("aria-disabled","false")),t?(r.feedbackNavNext.setAttribute("disabled","true"),r.feedbackNavNext.classList.add("disabled"),r.feedbackNavNext.setAttribute("aria-disabled","true")):(r.feedbackNavNext.removeAttribute("disabled"),r.feedbackNavNext.classList.remove("disabled"),r.feedbackNavNext.setAttribute("aria-disabled","false"))}async function we(){try{const t=(await pe({limit:W})).feedbacks||[];if(t.length===0){y("No feedbacks received from API");return}de(t),setTimeout(()=>{Ee(t.length)},50)}catch(e){k(e)}}async function Se(){if(!r.feedbackSwiper||!r.feedbackCardList||!r.feedbackNavPrev||!r.feedbackNavNext||!r.feedbackPaginationDots){y("Feedback section elements not found in DOM");return}await we()}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("[data-menu-open]"),t=document.querySelector(".burger-menu"),a=document.querySelector(".header-nav"),n=document.querySelector(".burger-menu-header-button"),o=document.body;if(!e||!t||!a){console.warn("Не знайдено елементи меню або хедеру");return}const s=document.createElement("button");s.classList.add("burger-menu-navbar-btn-close"),s.setAttribute("type","button"),s.setAttribute("data-navbar-close",""),s.innerHTML=`
    <svg width="32" height="32">
      <use href="/img/sprite.svg#x"></use>
    </svg>
  `,e.insertAdjacentElement("beforebegin",s),e.addEventListener("click",()=>{t.classList.add("is-open"),o.classList.add("no-scroll"),e.style.display="none",s.style.display="flex"});const i=()=>{t.classList.remove("is-open"),o.classList.remove("no-scroll"),e.style.display="flex",s.style.display="none"};s.addEventListener("click",i),n.addEventListener("click",i),t.querySelectorAll(".nav-link").forEach(u=>u.addEventListener("click",i)),document.addEventListener("keydown",u=>{u.key==="Escape"&&t.classList.contains("is-open")&&i()}),s.style.display="none"});window.addEventListener("load",()=>{requestAnimationFrame(()=>{window.scrollTo({top:0,left:0,behavior:"auto"})})});document.addEventListener("DOMContentLoaded",he);document.addEventListener("DOMContentLoaded",Se);r.categories.addEventListener("click",Y);r.loadMoreBtn.addEventListener("click",J);document.addEventListener("DOMContentLoaded",()=>{r.categories&&!r.categories.dataset.bound&&(r.categories.addEventListener("click",Y),r.categories.dataset.bound="1"),r.loadMoreBtn&&!r.loadMoreBtn.dataset.bound&&(r.loadMoreBtn.addEventListener("click",J),r.loadMoreBtn.dataset.bound="1");const e=r.products||document.getElementById("products");e&&e.dataset.boundModal!=="1"&&(e.addEventListener("click",Le),e.dataset.boundModal="1")});
//# sourceMappingURL=index.js.map
