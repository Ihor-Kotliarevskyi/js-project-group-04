import{A as D,a as f,i as w}from"./assets/vendor-BUlgoyLb.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const c={categories:document.querySelector("#categories"),products:document.querySelector("#products"),modal:document.querySelector(".modal"),modalProduct:document.querySelector(".modal-product"),loadMoreBtn:document.querySelector(".load-more-btn"),colorBox:document.querySelector(".products-color-list"),loader:document.querySelector(".loader"),feedbackCardList:document.querySelector(".feedback-card-list"),feedbackNavPrev:document.querySelector(".feedback-nav-prev"),feedbackNavNext:document.querySelector(".feedback-nav-next")};function W(t){const n=[{_id:"all",name:"Всі товари"},...t].map(({_id:o,name:r})=>`<li
        class="category-item" id="${o}"
        style="
          background-image: image-set(
            url('./furniture-bg/${o}.png') 1x,
            url('./furniture-bg/${o}@2x.png') 2x
          );
        "
      ><button class="categories-btn" type="button">${r}</button></li>`).join("");c.categories.innerHTML=n}function h(t){const e=t.map(({_id:n,name:o,images:r,price:s,color:l})=>`<li class="product-item" data-id="${n}">
        <img
          class="products-image"
          src='${r[0]}'
          alt="${o}"
        />
        <div class="product-description-box">
          <h4 class="products-title">${o}</h4>
          <ul class="products-color-list">
            ${l.map(L=>`<li class="products-color-box" style="background-color: ${L}"></li>`).join("")}
          </ul>
          <p class="products-price">${s} грн</p>
        </div>
        <button class="products-details-btn" type="button">Детальніше</button>
      </li>`).join("");c.products.insertAdjacentHTML("beforeend",e)}function j(){c.products.innerHTML=""}new D(".accordion-container",{duration:300,showMultiple:!1});const z="https://furniture-store-v2.b.goit.study/api",M={FURNITURES:"/furnitures",CATEGORIES:"/categories"},v=8;f.defaults.baseURL=z;async function $(t=1){const{data:e}=await f(`${M.FURNITURES}?page=${t}&limit=${v}`);return e}async function N(t,e){const{data:n}=await f(`${M.FURNITURES}?page=${e}&limit=${v}&category=${t}`);return n}async function _(){return(await f.get(M.CATEGORIES)).data}function C(){setTimeout(()=>{c.loadMoreBtn.classList.add("is-show")},500)}function g(){c.loadMoreBtn.classList.remove("is-show")}f.defaults.baseURL="https://furniture-store-v2.b.goit.study/api";const a=document.querySelector(".modal-window");let y=null,b=null;function G(t=0){const e=Math.floor(t),n=t%1>=.5?1:0;let o="";for(let r=0;r<e;r++)o+='<span class="star star-full">★</span>';n&&(o+='<span class="star star-half">★</span>');for(let r=e+n;r<5;r++)o+='<span class="star star-empty">★</span>';return o}function K(t){const e="https://furniture-store-v2.b.goit.study";return(t||[]).map(n=>typeof n=="string"&&n.startsWith("http")?n:`${e}${n}`)}function J(){return{dialog:a.querySelector(".product-modalWindow"),mainImg:a.querySelector(".modal-image-0"),thumbsWrap:a.querySelector(".modal-bottom-row"),titleEl:a.querySelector(".product-modal-title"),catEl:a.querySelector(".modal-description"),priceEl:a.querySelector(".modal-price"),starsEl:a.querySelector(".modal-rating-stars"),colorsWrap:a.querySelector(".radio-group"),descEl:a.querySelector(".furnitureDescription"),sizeEl:a.querySelector(".furnitureSize"),btnClose:a.querySelector(".modal-close-btn"),orderBtn:a.querySelector(".modalButton")}}async function Q(t){try{document.body.classList.add("modal-open"),a.classList.remove("visuallyhidden");const{data:e}=await f.get(`/furnitures/${t}`),{dialog:n,mainImg:o,thumbsWrap:r,titleEl:s,catEl:l,priceEl:L,starsEl:I,colorsWrap:T,descEl:B,sizeEl:R,btnClose:x,orderBtn:P}=J(),A=K(e.images||e.image||[]),O=A.length?A:["https://via.placeholder.com/640x360?text=No+Image"],U=O[0],H=O.slice(1,3);if(o&&(o.src=U,o.alt=e?.name||"photo"),r&&(r.innerHTML=H.map(i=>`<img class="modal-thumb" src="${i}" alt="${e?.name||"thumb"}">`).join(""),r.dataset.bound||(r.addEventListener("click",i=>{const d=i.target.closest(".modal-thumb");if(!d||!o)return;const k=o.src;o.src=d.src,d.src=k}),r.dataset.bound="1")),s&&(s.textContent=e?.name||""),l&&(l.textContent=e?.category?.name||"Без категорії"),L&&(L.textContent=`${e?.price??0} грн`),I&&(I.innerHTML=G(e?.rate||0)),T){const i=Array.isArray(e?.color)?e.color:[];T.innerHTML=i.map((d,k)=>`<label><input type="radio" name="color" value="${d}" ${k===0?"checked":""}><span class="color-circle" style="background:${d}"></span></label>`).join("")}B&&(B.textContent=e?.description||"Опис відсутній"),R&&(R.textContent=`Розміри: ${e?.sizes||"—"}`),x&&(x.onclick=p),b=i=>{i.target===a&&p()},a.addEventListener("mousedown",b),y=i=>{i.key==="Escape"&&p()},document.addEventListener("keydown",y),P&&(P.onclick=()=>{const i=a.querySelector('input[name="color"]:checked'),d=i?i.value:null;p(),document.dispatchEvent(new CustomEvent("openOrderModal",{detail:{id:t,color:d}}))}),n&&(n.setAttribute("tabindex","-1"),n.focus({preventScroll:!0}))}catch(e){console.error("❌ Помилка завантаження товару",e),p()}}function p(){a.classList.add("visuallyhidden"),document.body.classList.remove("modal-open"),y&&(document.removeEventListener("keydown",y),y=null),b&&(a.removeEventListener("mousedown",b),b=null)}const S=document.querySelector(".backdrop");document.querySelector(".order-modal");const V=document.querySelector(".modal-close-btn");document.querySelector(".modal-submit-btn");const E=document.querySelector(".modal-order-form");async function X(){S.classList.add("is-open"),document.body.classList.add("modal-open"),await new Promise(t=>setTimeout(t,300)),window.addEventListener("keydown",F)}async function q(){S.classList.remove("is-open"),document.body.classList.remove("modal-open"),await new Promise(t=>setTimeout(t,300)),window.removeEventListener("keydown",F)}V.addEventListener("click",async()=>{q()});S.addEventListener("click",async t=>{t.target===S&&await q()});function F(t){(t.key==="Escape"||t.key==="Esc")&&q()}E.addEventListener("submit",async t=>{t.preventDefault();const e=E.elements["user-name"].value.trim(),n=E.elements.phone.value.trim();if(!e||!n){w.warning({title:"Упс!",message:"Будь ласка, заповніть всі обов'язкові поля!",position:"topRight"});return}const o=n.replace(/[^\d+]/g,"");if(!/^\+?\d{10,15}$/.test(o)){w.warning({title:"Упс!",message:"Будь ласка, введіть коректний номер телефону",position:"topRight"});return}try{await new Promise(s=>setTimeout(s,500)),w.success({title:"Успішно!",message:"Ваше замовлення відправлено!",position:"topRight"}),E.reset(),await q()}catch{w.error({title:"Помилка!",message:"Щось пішло не так. Спробуйте ще раз.",position:"topRight"})}});document.querySelector(".open-modal-btn")?.addEventListener("click",async()=>{await X()});let u=1,m="";async function Y(){try{const t=await _();W(t),m="all",c.categories.children[0].classList.add("categories-item--active");const{furnitures:n}=await $();h(n),C()}catch{}finally{}}async function Z(t){const e=t.target.closest(".category-item");if(!e)return;[...t.currentTarget.children].map(o=>{o.classList.remove("categories-item--active")}),j(),e.classList.add("categories-item--active"),u=1,m=e.id;try{if(m==="all"){const{furnitures:o}=await $();h(o),C()}else{const{furnitures:o,totalItems:r}=await N(m,u);if(o.length)r<v&&g(),h(o);else{g();return}}}catch{}finally{}}async function ee(t){t.preventDefault(),u++;try{if(m==="all"){const{furnitures:e,totalItems:n}=await $(u);n<v*u?g():C(),h(e)}else{const{furnitures:e,totalItems:n}=await N(m,u);if(e.length)n<v&&g(),h(e);else{g();return}}}catch{}finally{}}const te=t=>{const e=t.target.closest(".products-details-btn");if(!e)return;const n=e.closest(".product-item");if(!n)return;let o=n.dataset.id;if(!o){const l=(n.querySelector('img[src*="/furniture/"]')?.getAttribute("src")||"").match(/\/([a-f0-9]{24})_/i);l&&(o=l[1])}if(!o){console.warn("Не знайдено id товару для модалки");return}t.preventDefault(),Q(o)};window.addEventListener("load",()=>{requestAnimationFrame(()=>{window.scrollTo({top:0,left:0,behavior:"auto"})})});document.addEventListener("DOMContentLoaded",()=>{Y(),c.categories&&!c.categories.dataset.bound&&(c.categories.addEventListener("click",Z),c.categories.dataset.bound="1"),c.loadMoreBtn&&!c.loadMoreBtn.dataset.bound&&(c.loadMoreBtn.addEventListener("click",ee),c.loadMoreBtn.dataset.bound="1");const t=c.products||document.getElementById("products");t&&t.dataset.boundModal!=="1"&&(t.addEventListener("click",te),t.dataset.boundModal="1")});
//# sourceMappingURL=index.js.map
