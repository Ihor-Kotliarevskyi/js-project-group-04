import{A as V,a as p,i as w,S as J,N as Q,P as X}from"./assets/vendor-0aAj9oPQ.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();const a={categories:document.querySelector("#categories"),products:document.querySelector("#products"),modal:document.querySelector(".modal"),modalProduct:document.querySelector(".modal-product"),loadMoreBtn:document.querySelector(".load-more-btn"),colorBox:document.querySelector(".products-color-list"),loader:document.querySelector(".loader"),feedbackCardList:document.querySelector(".feedback-card-list"),feedbackNavPrev:document.querySelector(".feedback-nav-prev"),feedbackNavNext:document.querySelector(".feedback-nav-next"),feedbackPaginationDots:document.querySelector(".feedback-pagination-dots"),feedbackSwiper:document.querySelector(".feedback-swiper"),loader:document.querySelector(".loader")};function C(){setTimeout(()=>{a.loadMoreBtn.classList.add("is-show")},500)}function v(){a.loadMoreBtn.classList.remove("is-show")}function Y(e){return e<1||e>5?e:e>=3.3&&e<=3.7?3.5:e>=3.8&&e<=4.2?4:Math.round(e*2)/2}function Z(e){const o=[{_id:"all",name:"Всі товари"},...e].map(({_id:n,name:r})=>`<li
        class="category-item" id="${n}"
        style="
          background-image: image-set(
            url('./furniture-bg/${n}.png') 1x,
            url('./furniture-bg/${n}@2x.png') 2x
          );
        "
      ><button class="categories-btn" type="button">${r}</button></li>`).join("");a.categories.innerHTML=o}function E(e){const t=e.map(({_id:o,name:n,images:r,price:s,color:c})=>`<li class="product-item" data-id="${o}">
        <img
          class="products-image"
          src='${r[0]}'
          alt="${n}"
        />
        <div class="product-description-box">
          <h4 class="products-title">${n}</h4>
          <ul class="products-color-list">
            ${c.map(d=>`<li class="products-color-box" style="background-color: ${d}"></li>`).join("")}
          </ul>
          <p class="products-price">${s} грн</p>
        </div>
        <button class="products-details-btn" type="button">Детальніше</button>
      </li>`).join("");a.products.insertAdjacentHTML("beforeend",t)}function ee(){a.products.innerHTML=""}new V(".accordion-container",{duration:300,showMultiple:!1,beforeOpen:e=>{const t=e.querySelector(".ac-icon");t&&(t.style.transform="rotate(180deg)")},beforeClose:e=>{const t=e.querySelector(".ac-icon");t&&(t.style.transform="rotate(0deg)")}});function te(e){const t=e.rate??0,o=Y(t),n=Math.max(0,Math.min(5,Math.floor(o))),r=o%1!==0,s=["feedback-rating","rating","small","star-icon","color-default",`value-${n}`];r&&s.push("half");const c=Array.from({length:5}).map(()=>`<div class="star icon default">
            <i class="star-empty"></i>
            <i class="star-half"></i>
            <i class="star-filled"></i>
          </div>`).join("");return`
    <li class="swiper-slide feedback-card-item">
      <div class="${s.join(" ")}" data-rating="${o}" aria-label="Рейтинг ${o} з 5">
        <div class="star-container">
          ${c}
        </div>
      </div>
      <p class="feedback-text">${e.descr||""}</p>
      <p class="feedback-author">${e.name||""}</p>
    </li>
  `}function re(e){if(!a.feedbackCardList)return;const t=e.map(o=>te(o)).join("");a.feedbackCardList.innerHTML=t}const oe="https://furniture-store-v2.b.goit.study/api",M={FURNITURES:"/furnitures",CATEGORIES:"/categories",FEEDBACKS:"/feedbacks"},ae=1,L=8,ne=1,O=10;p.defaults.baseURL=oe;async function A(e=ae){const{data:t}=await p(`${M.FURNITURES}?page=${e}&limit=${L}`);return t}async function U(e,t){const{data:o}=await p(`${M.FURNITURES}?page=${t}&limit=${L}&category=${e}`);return o}async function se(){return(await p.get(M.CATEGORIES)).data}async function ie(e={page:ne,limit:O}){return(await p.get(M.FEEDBACKS,{params:e})).data}p.defaults.baseURL="https://furniture-store-v2.b.goit.study/api";const i=document.querySelector(".modal-window");let k=null,h=null;function ce(e=0){const t=Math.floor(e),o=e%1>=.5?1:0;let n="";for(let r=0;r<t;r++)n+='<span class="star star-full">★</span>';o&&(n+='<span class="star star-half">★</span>');for(let r=t+o;r<5;r++)n+='<span class="star star-empty">★</span>';return n}function le(e){const t="https://furniture-store-v2.b.goit.study";return(e||[]).map(o=>typeof o=="string"&&o.startsWith("http")?o:`${t}${o}`)}function de(){return{dialog:i.querySelector(".product-modalWindow"),mainImg:i.querySelector(".modal-image-0"),thumbsWrap:i.querySelector(".modal-bottom-row"),titleEl:i.querySelector(".product-modal-title"),catEl:i.querySelector(".modal-description"),priceEl:i.querySelector(".modal-price"),starsEl:i.querySelector(".modal-rating-stars"),colorsWrap:i.querySelector(".radio-group"),descEl:i.querySelector(".furnitureDescription"),sizeEl:i.querySelector(".furnitureSize"),btnClose:i.querySelector(".modal-close-btn"),orderBtn:i.querySelector(".modalButton")}}async function ue(e){try{document.body.classList.add("modal-open"),i.classList.remove("visuallyhidden");const{data:t}=await p.get(`/furnitures/${e}`),{dialog:o,mainImg:n,thumbsWrap:r,titleEl:s,catEl:c,priceEl:d,starsEl:$,colorsWrap:x,descEl:B,sizeEl:I,btnClose:T,orderBtn:F}=de(),R=le(t.images||t.image||[]),D=R.length?R:["https://via.placeholder.com/640x360?text=No+Image"],_=D[0],K=D.slice(1,3);if(n&&(n.src=_,n.alt=t?.name||"photo"),r&&(r.innerHTML=K.map(l=>`<img class="modal-thumb" src="${l}" alt="${t?.name||"thumb"}">`).join(""),r.dataset.bound||(r.addEventListener("click",l=>{const u=l.target.closest(".modal-thumb");if(!u||!n)return;const q=n.src;n.src=u.src,u.src=q}),r.dataset.bound="1")),s&&(s.textContent=t?.name||""),c&&(c.textContent=t?.category?.name||"Без категорії"),d&&(d.textContent=`${t?.price??0} грн`),$&&($.innerHTML=ce(t?.rate||0)),x){const l=Array.isArray(t?.color)?t.color:[];x.innerHTML=l.map((u,q)=>`<label><input type="radio" name="color" value="${u}" ${q===0?"checked":""}><span class="color-circle" style="background:${u}"></span></label>`).join("")}B&&(B.textContent=t?.description||"Опис відсутній"),I&&(I.textContent=`Розміри: ${t?.sizes||"—"}`),T&&(T.onclick=y),h=l=>{l.target===i&&y()},i.addEventListener("mousedown",h),k=l=>{l.key==="Escape"&&y()},document.addEventListener("keydown",k),F&&(F.onclick=()=>{const l=i.querySelector('input[name="color"]:checked'),u=l?l.value:null;y(),document.dispatchEvent(new CustomEvent("openOrderModal",{detail:{id:e,color:u}}))}),o&&(o.setAttribute("tabindex","-1"),o.focus({preventScroll:!0}))}catch(t){console.error("❌ Помилка завантаження товару",t),y()}}function y(){i.classList.add("visuallyhidden"),document.body.classList.remove("modal-open"),k&&(document.removeEventListener("keydown",k),k=null),h&&(i.removeEventListener("mousedown",h),h=null)}const S=document.querySelector(".backdrop");document.querySelector(".order-modal");const fe=document.querySelector(".modal-close-btn");document.querySelector(".modal-submit-btn");const m=document.querySelector(".modal-order-form");let H=null,j=null;async function me(e,t){H=e,j=t,S.classList.add("is-open"),document.body.classList.add("modal-open"),await new Promise(o=>setTimeout(o,300)),window.addEventListener("keydown",G)}async function N(){S.classList.remove("is-open"),document.body.classList.remove("modal-open"),await new Promise(e=>setTimeout(e,300)),window.removeEventListener("keydown",G)}fe.addEventListener("click",async()=>{N()});S.addEventListener("click",async e=>{e.target===S&&await N()});function G(e){(e.key==="Escape"||e.key==="Esc")&&N()}m.addEventListener("submit",async e=>{e.preventDefault();const t=m.elements["user-name"].value.trim(),o=m.elements.phone.value.trim();if(!t||!o){w.warning({title:"Упс!",message:"Будь ласка, заповніть всі обов'язкові поля!",position:"topRight"});return}const n=o.replace(/[^\d+]/g,"");if(!/^\+?\d{10,15}$/.test(n)){w.warning({title:"Упс!",message:"Будь ласка, введіть коректний номер телефону",position:"topRight"});return}const s={name:t,phone:n,comment,productId:H,marker:j};try{if(!(await fetch("https://furniture-store-v2.b.goit.study/api-docs/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw new Error("Не вдалось створити замовлення. Спробуйте ще раз");w.success({title:"Успішно!",message:"Ваше замовлення відправлено!",position:"topRight",timeout:3e3}),m.reset(),await N()}catch{w.error({title:"Помилка!",message:"Щось пішло не так. Спробуйте ще раз.",position:"topRight"})}});function pe(e){const t=e.target;localStorage.setItem(t.name,t.value)}m.querySelectorAll("input, textarea").forEach(e=>{e.addEventListener("input",pe)});m.querySelectorAll("input, textarea").forEach(e=>{const t=localStorage.getItem(e.name);t&&(e.value=t)});m.addEventListener("submit",()=>{m.querySelectorAll("input, textarea").forEach(e=>{localStorage.removeItem(e.name)})});document.querySelector(".open-modal-btn")?.addEventListener("click",async()=>{await me()});let b=1,g="";async function be(){try{const e=await se();Z(e),g="all",a.categories.children[0].classList.add("categories-item--active");const{furnitures:o}=await A();E(o),C()}catch{}finally{}}async function z(e){const t=e.target.closest(".category-item");if(!t)return;[...e.currentTarget.children].map(n=>{n.classList.remove("categories-item--active")}),ee(),t.classList.add("categories-item--active"),b=1,g=t.id;try{if(g==="all"){const{furnitures:n}=await A();E(n),C()}else{const{furnitures:n,totalItems:r}=await U(g,b);if(n.length)r<L&&v(),E(n);else{v();return}}}catch{}finally{}}async function W(e){e.preventDefault(),b++;try{if(g==="all"){const{furnitures:t,totalItems:o}=await A(b);o<L*b?v():C(),E(t)}else{const{furnitures:t,totalItems:o}=await U(g,b);if(t.length)o<L&&v(),E(t);else{v();return}}}catch{}finally{}}const ge=e=>{const t=e.target.closest(".products-details-btn");if(!t)return;const o=t.closest(".product-item");if(!o)return;let n=o.dataset.id;if(!n){const c=(o.querySelector('img[src*="/furniture/"]')?.getAttribute("src")||"").match(/\/([a-f0-9]{24})_/i);c&&(n=c[1])}if(!n){console.warn("Не знайдено id товару для модалки");return}e.preventDefault(),ue(n)};document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("[data-menu-open]"),t=document.querySelector(".burger-menu"),o=document.querySelector(".header-nav"),n=document.body;if(!e||!t||!o){console.warn("Не знайдено елементи меню або хедеру");return}const r=document.createElement("button");r.classList.add("burger-menu-navbar-btn-close"),r.setAttribute("type","button"),r.setAttribute("data-navbar-close",""),r.innerHTML=`
    <svg width="32" height="32">
      <use href="/img/sprite.svg#x"></use>
    </svg>
  `,e.insertAdjacentElement("beforebegin",r),e.addEventListener("click",()=>{t.classList.add("is-open"),n.classList.add("no-scroll"),e.style.display="none",r.style.display="flex"});const s=()=>{t.classList.remove("is-open"),n.classList.remove("no-scroll"),e.style.display="flex",r.style.display="none"};r.addEventListener("click",s),t.querySelectorAll(".nav-link").forEach(d=>d.addEventListener("click",s)),document.addEventListener("keydown",d=>{d.key==="Escape"&&t.classList.contains("is-open")&&s()}),r.style.display="none"});let f=null;function ye(e=10){if(!(!a.feedbackSwiper||!a.feedbackCardList))return f&&(f.destroy(!0,!0),f=null),f=new J(a.feedbackSwiper,{modules:[Q,X],slidesPerView:1,slidesPerGroup:1,spaceBetween:24,loop:!1,grabCursor:!0,allowTouchMove:!0,touchRatio:1,simulateTouch:!0,watchSlidesProgress:!0,navigation:{nextEl:a.feedbackNavNext,prevEl:a.feedbackNavPrev},pagination:{el:a.feedbackPaginationDots,clickable:!0,bulletClass:"feedback-pagination-dot",bulletActiveClass:"active",type:"bullets",dynamicBullets:!1},breakpoints:{375:{slidesPerView:1,slidesPerGroup:1,spaceBetween:16},768:{slidesPerView:2,slidesPerGroup:1,spaceBetween:24},1200:{slidesPerView:3,slidesPerGroup:1,spaceBetween:24}},on:{init:function(){P()},slideChange:function(){P()},resize:function(){P()}}}),f}function P(){if(!f||!a.feedbackNavPrev||!a.feedbackNavNext)return;const e=f.isBeginning,t=f.isEnd;e?(a.feedbackNavPrev.setAttribute("disabled","true"),a.feedbackNavPrev.classList.add("disabled"),a.feedbackNavPrev.setAttribute("aria-disabled","true")):(a.feedbackNavPrev.removeAttribute("disabled"),a.feedbackNavPrev.classList.remove("disabled"),a.feedbackNavPrev.setAttribute("aria-disabled","false")),t?(a.feedbackNavNext.setAttribute("disabled","true"),a.feedbackNavNext.classList.add("disabled"),a.feedbackNavNext.setAttribute("aria-disabled","true")):(a.feedbackNavNext.removeAttribute("disabled"),a.feedbackNavNext.classList.remove("disabled"),a.feedbackNavNext.setAttribute("aria-disabled","false"))}async function ve(){try{const t=(await ie({limit:O})).feedbacks||[];if(t.length===0){console.warn("No feedbacks received from API");return}re(t),setTimeout(()=>{ye(t.length)},50)}catch(e){console.error("Error loading feedbacks:",e)}}async function ke(){if(!a.feedbackSwiper||!a.feedbackCardList||!a.feedbackNavPrev||!a.feedbackNavNext||!a.feedbackPaginationDots){console.warn("Feedback section elements not found in DOM");return}await ve()}window.addEventListener("load",()=>{requestAnimationFrame(()=>{window.scrollTo({top:0,left:0,behavior:"auto"})})});document.addEventListener("DOMContentLoaded",be);document.addEventListener("DOMContentLoaded",ke);a.categories.addEventListener("click",z);a.loadMoreBtn.addEventListener("click",W);document.addEventListener("DOMContentLoaded",()=>{a.categories&&!a.categories.dataset.bound&&(a.categories.addEventListener("click",z),a.categories.dataset.bound="1"),a.loadMoreBtn&&!a.loadMoreBtn.dataset.bound&&(a.loadMoreBtn.addEventListener("click",W),a.loadMoreBtn.dataset.bound="1");const e=a.products||document.getElementById("products");e&&e.dataset.boundModal!=="1"&&(e.addEventListener("click",ge),e.dataset.boundModal="1")});
//# sourceMappingURL=index.js.map
